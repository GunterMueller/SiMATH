/*M
.SH NAME
manftrace - matrix of number field elements, trace

.SH SYNOPSIS
.nf
#include<_matr2.h>

nfel manftrace(F, M)
obj F;
matrix M;

.SH DESCRIPTION
manftrace() returns the trace of the matrix M.



.PP
.TP 4
.B F
is an irreducible monic dense polynomial in one variable over Z.
.TP 4
.B M
is a square matrix over the number field generated by F.
M*/
/*H
	Version 1       11.07.1994      S. Schmitt
   DATE	manftrace     : 941201
H*/

#include <_matr2.h>

nfel manftrace(F,M)
obj F;
matrix M;
{
	single i,j;
	list Z1;
	obj S;
	bind(F,M);
	init(S);
                
	S = itonf(0);
	i = 0;
	while ( M != _0 ) {
		i++;
		Z1 = lfirst(M);
		M  = lred(M);
		for(j=1;j<i;j++) Z1=lred(Z1);
		S = nfsum(F,S,lfirst(Z1));
	}
	return(S);
}
