/*M
.SH NAME
vecnfssmul - vector of number field elements, sparse representation, scalar multiplication

.SH SYNOPSIS
.nf
#include<_matr2.h>

vec vecnfssmul(F, V, el)
pol F;
vec V;
nfel el;

.SH DESCRIPTION
vecnfssmul() returns the vector el*V.

.PP
.TP 4
.B F
is an irreducible sparse polynomial in one variable over the rational numbers.
.TP 4
.B V
is a vector over the number field generated by F.
.TP 4
.B el
is an element of the number field generated by F.
M*/


/*H
	Version 1       11.04.1990      Th. Weis
    DATE vecnfssmul   : 910915
H*/

#include <_matr2.h>

vec vecnfssmul( F, V, el )
pol    F;
vec    V;
nfel   el;

{          
	nfel   e;
	single n;
	vec    W;

	bind( F, V, el );
	init( e, W );

/* el gleich 0 */

	if( !el )
	{
	   n = llength( V );
	   W = _0;
	   while( n-- ) W = lcomp( 0, W );
	}

/* allgemeiner Fall */

	else
	{
	   W = _0;
	   do
	   {
	      e = lfirst( V );
	      V = lred( V );
	      e = nfsprod( F, e, el );
	      W = lcomp( e, W );
	   }
	   while ( V != _0 );
	   W = linv( W );
	}
	return( W );
}
