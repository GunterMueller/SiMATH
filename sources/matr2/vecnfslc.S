/*M
.SH NAME
vecnfslc - vector of number field elements, sparse representation, linear combination

.SH SYNOPSIS
.nf
#include<_matr2.h>

vec vecnfslc(F, s1, s2, L1, L2)
pol F;
nfel s1,s2;
vec L1,L2;

.SH DESCRIPTION
vecnfslc() returns the linear combination (s1*V1)+(s2*V2).

.PP
.TP 4
.B F
is an irreducible monic sparse polynomial in one variable over the rational numbers.
.TP 4
.B s1,s2
are elements of the number field generated by F.
.TP 4
.B V1,V2
are vectors over the number field generated by F.
V1 and V2 must have equal length.
M*/
/*H
	Version 1       12.04.1990      Th. Weis
   DATE vecnfslc      : 910915
H*/

#include <_matr2.h>

vec vecnfslc( F, s1, s2, L1, L2 )
pol  F;
nfel s1, s2;
vec  L1, L2;

{
	vec  Z;
	nfel a1, a2;

	bind( F, s1, s2, L1, L2 );
	init( Z, a1, a2 );

	Z = _0;
	while ( L1 != _0 )
	{
	   a1 = nfsprod( F, s1, lfirst( L1 ) );
	   a2 = nfsprod( F, s2, lfirst( L2 ) );
	   a1 = nfssum( F, a1, a2 );
	   L1 = lred( L1 );
	   L2 = lred( L2 );
	   Z = lcomp( a1, Z );
	}
	Z = linv( Z );
	return( Z );
}
