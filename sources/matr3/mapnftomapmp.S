/*M
.SH NAME
mapnftomapmp - matrix of polynomials over number field to matrix of polynomials modulo polynomial over number field

.SH SYNOPSIS
.nf
#include<_matr3.h>

matrix mapnftomapmp(r, F, P, M)
single r;
pol F,P;
matrix M;

.SH DESCRIPTION
mapnftomapmp() returns the matrix M with all entries converted
to polynomials in r variables over the number field generated by F.
These polynomials are reduced modulo P.

.PP
.TP 4
.B F
is an irreducible monic dense polynomial in one variable over Z.
.TP 4
.B P
is a polynomial in r variables over the number field generated by F.
M*/






/*H
	Version 1       18.09.1992	U.Schneiders
   DATE mapnftomapmp  : 921130
H*/

#include <_matr3.h>

matrix mapnftomapmp( r, F, P, M )
single r;
pol F, P;
matrix M;
{
	pol el;
	matrix H;
	list Z, ZH;
	init(el,H,Z,ZH);
	bind(F,P,M);

	H = _0;
	while( M != _0 )
	{	Z = lfirst( M );
		M = lred( M );
		ZH = _0;
		while ( Z != _0 ) 
	        {	el = lfirst(Z);
			Z  = lred(Z);
			el = pnfrem(r,F,el,P);
			ZH = lcomp(el,ZH);
		}
		if( ZH != _0 ) ZH = linv( ZH );
		H = lcomp( ZH, H );
	}
	if ( H != _0 ) M = linv(H);
	return(M);
}


