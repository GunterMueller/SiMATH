/*M
.SH NAME
pgfsefe - polynomial over Galois-field with single characteristic embedding in field extension
(recursive)

.SH SYNOPSIS
.nf
#include<_pol3.h>

pol pgfsefe(r, p, ALm, P, g)  
single r, p; 
list ALm; 
pol P; 
gfel g;

.SH DESCRIPTION
.TP 4
.B r
is an integer number, 0 <= r < BASIS.
.TP 4
.B p
is a prime number, p < BASIS.
.TP 4
.B ALm
is the arithmetic list of GF(p^m) (s. gfsalgen).
.TP 4
.B P
is a polynomial in r variables over GF(p^n), 1 < n < m < BASIS, n divides m.
.PP
The arithmetic list of GF(p^n) hat to be generated by gfsalgenies.
.TP 4
.B g
is an univariate polynomial and complies with the image of the separable generator of GF(p^n) over GF(p) under the isomorphic embedding of GF(p^n) in GF(p^m) found by gfsalgenies.
g is of type gfel, i.e. an univariate sparse polynomial with coefficients in Z/pZ.
.PP
pgfsefe returns the representation of P as a polynomial over GF(p^m).
                          
.SH SEE ALSO
.nf
gfsalgen
gfsalgenies
M*/
             
/*H
	Version  1      19.05.1993      S.Schmitt
   DATE pgfsefe       : 931130
H*/
 
#include <_pol3.h>

pol pgfsefe( r,p,ALm,P,g )
single r,p;
list ALm;
pol P;
gfel g;
{ 
	pol Q;
	obj a, e;
	init(Q, a, e);
	bind(ALm,P,g);


/* P gleich 0 */

	if (P == 0) Q = 0;

/* r gleich 0 */

	else if (r == 0)     Q=gfsefe(p,ALm,P,g);

/* allgemeiner Fall: P,r ungleich 0*/

	else 
	{ 	r--;
		Q = _0;
		while(P!=_0) 
		{ 	e = lfirst(P);
			a = lsecond(P);
			P = lred2(P);
			a = pgfsefe(r,p,ALm,a,g);
			if(a)   Q = lcomp2(a,e,Q);
		}
		if(Q==_0)  Q=0;
		else  Q = linv(Q);
	}
	return(Q);
}
